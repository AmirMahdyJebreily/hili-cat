# راهنمای کانفیگ زبان‌ها برای هایلی-کت

این راهنما نحوه ساخت و شخصی‌سازی کانفیگ زبان‌ها برای ابزار `hili-cat` رو توضیح میده. هایلی-کت یک ابزار هایلایت سینتکس سبک مخصوص لینوکسه.

## فهرست مطالب
- [آشنایی با فایل کانفیگ](#آشنایی-با-فایل-کانفیگ)
- [اضافه کردن زبان جدید](#اضافه-کردن-زبان-جدید)
- [نکات مهم برای نوشتن الگوهای regex](#نکات-مهم-برای-نوشتن-الگوهای-regex)
- [استایل‌های موجود](#استایلهای-موجود)
- [تست کردن کانفیگ](#تست-کردن-کانفیگ)
- [بهینه‌سازی الگوهای regex](#بهینهسازی-الگوهای-regex)
- [مثال‌ها](#مثالها)

## آشنایی با فایل کانفیگ

هایلی-کت از یه فایل کانفیگ JSON برای تعریف قوانین هایلایت سینتکس زبان‌های مختلف استفاده می‌کنه. کانفیگ پیش‌فرض در مسیر `/etc/highlight/config.json` ذخیره میشه (این مسیر موقع اولین اجرای برنامه به صورت خودکار ساخته میشه).

### ساختار کانفیگ

```json
{
  "languages": {
    "language-name": {
      "extensions": ["ext1", "ext2"],
      "rules": [
        {
          "name": "rule-name",
          "pattern": "regex-pattern",
          "style": "style-name"
        }
      ],
      "styles": {
        "style-name": "color-name"
      }
    }
  }
}
```

### عناصر کلیدی

1. **`language-name`**: شناسه برای زبان (مثلاً "go"، "python"، "javascript")
2. **`extensions`**: پسوندهای فایل مرتبط با این زبان (مثلاً ["go"]، ["py"]، ["js", "jsx"])
3. **`rules`**: آرایه‌ای از قوانین برجسته‌سازی، هر کدام شامل:
   - **`name`**: نام توصیفی برای قانون (مثلاً "keywords"، "strings"، "comments")
   - **`pattern`**: الگوی عبارت منظم برای تطبیق عناصر کد
   - **`style`**: ارجاع به سبک تعریف شده در بخش styles
4. **`styles`**: نگاشت نام‌های سبک به نام‌های رنگ یا کدهای رنگ ANSI

## افزودن زبان جدید

برای افزودن یک زبان جدید، مراحل زیر را دنبال کنید:

1. **شناسایی عناصر زبان** برای برجسته‌سازی:
   - کلمات کلیدی و کلمات رزرو شده
   - رشته‌ها و لیترال‌های رشته
   - نظرات (تک خطی و چند خطی)
   - اعداد و لیترال‌های عددی
   - توابع و تعاریف متد
   - عناصر نحوی خاص زبان

2. **ایجاد عبارات منظم** برای هر نوع عنصر:
   - از مرزهای کلمه (`\b`) برای کلمات کلیدی استفاده کنید
   - الگوهایی ایجاد کنید که دقیقاً با نحو زبان مطابقت داشته باشند
   - الگوها را در برابر کد نمونه آزمایش کنید

3. **تعریف سبک‌ها** برای هر نوع عنصر:
   - رنگ‌های مناسب برای خوانایی انتخاب کنید
   - کنتراست رنگ و دسترسی‌پذیری را در نظر بگیرید

4. **افزودن تعریف زبان** به فایل پیکربندی

## نکات نوشتن الگوهای عبارات منظم

عبارات منظم قدرتمند هستند، اما می‌توانند گیج‌کننده باشند. در اینجا برخی نکات آورده شده‌اند:

### الگوهای رایج

- **کلمات کلیدی**: `\\b(keyword1|keyword2|keyword3)\\b`
- **رشته‌ها**: `"[^"]*"` (با نقل قول دوگانه) یا `'[^']*'` (با نقل قول تکی)
- **اعداد**: `\\b\\d+(\\.\\d+)?\\b` (اعداد صحیح و اعشاری)
- **نظرات**: `//.*` (تک خطی) یا `/\\*[\\s\\S]*?\\*/` (چند خطی)
- **تعاریف تابع**: `\\bfunction\\s+([A-Za-z0-9_]+)\\s*\\(`

### ملاحظات مهم

- **بک‌اسلش‌ها را در JSON فرار دهید**: به جای `\`، در الگوها `\\` بنویسید
- **ترتیب مهم است**: قوانین به ترتیبی که ظاهر می‌شوند اعمال می‌شوند
- **تطابق‌های همپوشان**: مراقب الگوهایی که ممکن است همپوشانی داشته باشند، باشید
- **کارایی**: الگوهای پیچیده می‌توانند برجسته‌سازی را برای فایل‌های بزرگ کند کنند

## سبک‌های موجود

ابزار `hili-cat` از این کدهای رنگ و سبک ANSI پشتیبانی می‌کند:

### سبک‌های متن
- `bold` - متن پررنگ
- `italic` - متن مورب
- `underline` - متن زیرخط‌دار
- `reset` - بازنشانی همه سبک‌ها

### رنگ‌ها
- `black`، `red`، `green`، `yellow`، `blue`، `magenta`، `cyan`، `white`
- `brightblack`، `brightred`، `brightgreen`، `brightyellow`، `brightblue`، `brightmagenta`، `brightcyan`، `brightwhite`

## تست پیکربندی شما

پس از افزودن زبان جدید:

1. **ایجاد یک فایل نمونه** با زبان هدف
2. **اجرای hili-cat**: `hili-cat --config your-config.json sample-file.ext`
3. **تأیید برجسته‌سازی** طبق انتظار کار می‌کند
4. **تکرار و اصلاح** الگوهای خود در صورت نیاز

**نکته**: از آنجا که hili-cat فقط برای لینوکس است، تست باید در یک محیط لینوکس انجام شود.

## بهینه‌سازی الگوهای عبارات منظم

برای کارایی بهتر:

1. **الگوهای خاص را ترجیح دهید** نسبت به الگوهای عمومی
2. **از مرزهای کلمه** (`\b`) در صورت لزوم استفاده کنید
3. **از گروه‌های به دام انداختن بیش از حد اجتناب کنید**
4. **مراقب الگوهای بازگشتی** مانند `.*` باشید
5. **با فایل‌های بزرگ تست کنید** تا از کارایی اطمینان حاصل کنید

## مثال‌ها

### مثال ۱: پیکربندی زبان Ruby

```json
"ruby": {
  "extensions": ["rb"],
  "rules": [
    {
      "name": "keywords",
      "pattern": "\\b(begin|class|def|do|else|elsif|end|ensure|for|if|module|rescue|return|self|super|then|unless|until|when|while|yield)\\b",
      "style": "keyword"
    },
    {
      "name": "symbols",
      "pattern": ":[a-zA-Z_][a-zA-Z0-9_]*",
      "style": "symbol"
    },
    {
      "name": "strings",
      "pattern": "\"[^\"]*\"|'[^']*'",
      "style": "string"
    },
    {
      "name": "comments",
      "pattern": "#.*",
      "style": "comment"
    },
    {
      "name": "class_names",
      "pattern": "\\b[A-Z][a-zA-Z0-9_]*\\b",
      "style": "class"
    }
  ],
  "styles": {
    "keyword": "cyan",
    "symbol": "brightred",
    "string": "green",
    "comment": "brightblack",
    "class": "brightmagenta"
  }
}
```

### مثال ۲: افزودن پشتیبانی زبان CSS

```json
"css": {
  "extensions": ["css"],
  "rules": [
    {
      "name": "selectors",
      "pattern": "[.#]?[a-zA-Z0-9_-]+\\s*[,{]",
      "style": "selector"
    },
    {
      "name": "properties",
      "pattern": "[a-zA-Z-]+\\s*:",
      "style": "property"
    },
    {
      "name": "values",
      "pattern": ":\\s*[^;]+;",
      "style": "value"
    },
    {
      "name": "comments",
      "pattern": "/\\*[\\s\\S]*?\\*/",
      "style": "comment"
    },
    {
      "name": "units",
      "pattern": "\\d+(\\.\\d+)?(px|em|rem|vh|vw|%|s|ms)",
      "style": "unit"
    }
  ],
  "styles": {
    "selector": "brightcyan",
    "property": "yellow",
    "value": "green",
    "comment": "brightblack",
    "unit": "brightmagenta"
  }
}
```

---

[English](../en/CONFIG_GUIDE.md) | فارسی
